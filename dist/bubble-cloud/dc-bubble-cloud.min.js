/*!
 * dc-addons v0.8.1
 *
 * 2015-07-28 08:20:39
 *
 */
!function(){"use strict";dc.bubbleCloud=function(a,b){function c(){i.elasticRadius()&&i.r().domain([i.rMin(),i.rMax()]),i.r().range([n,i.xAxisLength()*i.maxBubbleRelativeSize()]),0===p.length?d():e(),h(),o=d3.layout.force().nodes(i.data()).size([i.width(),i.height()]),o.gravity(j).charge(g).friction(l).on("tick",function(a){p.each(f(a.alpha)).attr("cx",function(a){return a.x&&a.y&&d3.select(this.parentNode).attr("transform","translate("+a.x+","+a.y+")"),0}).attr("cy",function(a){return 0})}),o.start()}function d(){r=q.selectAll("g").data(i.data()).enter().append("g").attr("class",i.BUBBLE_NODE_CLASS).on("click",i.onClick),p=r.append("circle").attr("class",i.BUBBLE_CLASS).attr("r",0).attr("fill-opacity",1).attr("fill",function(a,b){return i.getColor(a,b)}).attr("stroke-width",2).on("mouseenter",function(a,b){d3.select(this).attr("stroke","#303030")}).on("mouseout",function(a,b){d3.select(this).attr("stroke","none")}),i._doRenderLabel(r),i._doRenderTitles(r),p.transition().duration(k).attr("r",function(a){return a.radius=i.bubbleR(a),a.x=Math.random()*i.width(),a.y=Math.random()*i.height(),a.radius})}function e(){p.data(i.data()).attr("r",function(a){return a.radius=i.bubbleR(a),a.radius}),i.doUpdateLabels(r),i.doUpdateTitles(r)}function f(a){var b=d3.geom.quadtree(i.data());return function(c){var d=c.radius+d3.max(i.data().map(function(a){return a.radius}))+m,e=c.x-d,f=c.x+d,g=c.y-d,h=c.y+d;b.visit(function(b,d,i,j,k){if(b.point&&b.point!==c){var l=c.x-b.point.x,n=c.y-b.point.y,o=Math.sqrt(l*l+n*n),p=c.radius+b.point.radius+m;p>o&&(o=(o-p)/o*a,c.x-=l*=o,c.y-=n*=o,b.point.x+=l,b.point.y+=n)}return d>f||e>j||i>h||g>k})}}function g(a){return-Math.pow(a.radius,2)/8}function h(){i.hasFilter()?r.each(function(a){i.hasFilter(i.keyAccessor()(a))?i.highlightSelected(this):i.fadeDeselected(this)}):r.each(function(){i.resetHighlight(this)})}var i=dc.bubbleMixin(dc.capMixin(dc.bubbleChart())),j=.2,k=1500,l=.5,m=10,n=5,o=null,p=[],q=null,r=null;return i._doRender=function(){return i.resetSvg(),q=i.svg().append("g"),p=[],c(),i},i._doRedraw=function(){return c(),i},i.anchor(a,b)}}();