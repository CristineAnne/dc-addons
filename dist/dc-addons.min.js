/*!
 * dc-addons v0.8.1
 *
 * 2015-07-28 08:20:40
 *
 */
!function(){"use strict";dc.baseMapChart=function(a){a=dc.baseChart(a);var b,c=!0,d=!1,e=!1,f=!1,g=!1,h=function(a){L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(a)},i=function(b){return a.title()(b)};return a._doRender=function(){},a._postRender=function(){},a.toLocArray=function(){},a.mapOptions=function(b){return arguments.length?(d=b,a):d},a.center=function(b){return arguments.length?(e=b,a):e},a.zoom=function(b){return arguments.length?(f=b,a):f},a.tiles=function(b){return arguments.length?(h=b,a):h},a.map=function(a){return arguments.length?b=a:b},a.popup=function(b){return arguments.length?(i=b,a):i},a.renderPopup=function(b){return arguments.length?(c=b,a):c},a.brushOn=function(b){return arguments.length?(g=b,a):g},a}}(),function(){"use strict";dc.baseLeafletChart=function(a){return a=dc.baseMapChart(a),a._doRender=function(){var b=L.map(a.root().node(),a.mapOptions());return a.center()&&a.zoom()&&b.setView(a.toLocArray(a.center()),a.zoom()),a.tiles()(b),a.map(b),a._postRender(),a._doRedraw()},a.toLocArray=function(a){return"string"==typeof a&&(a=a.split(",")),a},a}}(),function(){"use strict";dc.leafletChoroplethChart=function(a,b){var c=dc.colorChart(dc.baseLeafletChart({})),d=!1,e=[],f=!1,g={fillColor:"black",color:"gray",opacity:.4,fillOpacity:.6,weight:1},h=function(a){return a.key},i=function(a){var b=c.featureOptions();b instanceof Function&&(b=b(a)),b=JSON.parse(JSON.stringify(b));var d=e[c.featureKeyAccessor()(a)];return d&&d.d&&(b.fillColor=c.getColor(d.d,d.i),-1!==c.filters().indexOf(d.d.key)&&(b.opacity=.8,b.fillOpacity=1)),b};c._postRender=function(){d=L.geoJson(c.geojson(),{style:c.featureStyle(),onEachFeature:j}),c.map().addLayer(d)},c._doRedraw=function(){d.clearLayers(),e=[],c._computeOrderedGroups(c.data()).forEach(function(a,b){e[c.keyAccessor()(a)]={d:a,i:b}}),d.addData(c.geojson())},c.geojson=function(a){return arguments.length?(f=a,c):f},c.featureOptions=function(a){return arguments.length?(g=a,c):g},c.featureKeyAccessor=function(a){return arguments.length?(h=a,c):h},c.featureStyle=function(a){return arguments.length?(i=a,c):i};var j=function(a,b){var d=e[c.featureKeyAccessor()(a)];d&&d.d&&(b.key=d.d.key,c.renderPopup()&&b.bindPopup(c.popup()(d.d,a)),c.brushOn()&&b.on("click",k))},k=function(a){if(a.target){var b=a.target.key;dc.events.trigger(function(){c.filter(b),dc.redrawAll(c.chartGroup())})}};return c.anchor(a,b)}}(),function(){"use strict";dc.leafletMarkerChart=function(a,b){var c=dc.baseLeafletChart({}),d=!1,e=!1,f=!1,g=!0,h=!1,i=!0,j=!1,k=!1,l=!1,m=!1,n=!1,o=[],p=[],q=!1;c.renderTitle(!0);var r=function(a){return c.keyAccessor()(a)},s=function(a){var b=new L.Marker(c.toLocArray(c.locationAccessor()(a)),{title:c.renderTitle()?c.title()(a):"",alt:c.renderTitle()?c.title()(a):"",icon:t(),clickable:c.renderPopup()||c.brushOn()&&!h,draggable:!1});return b},t=function(){return new L.Icon.Default};c._postRender=function(){c.brushOn()&&(h&&c.filterHandler(x),c.map().on("zoomend moveend",w,this),h||c.map().on("click",w,this),c.map().on("zoomstart",v,this)),n=d?new L.MarkerClusterGroup(e?e:null):new L.LayerGroup,c.map().addLayer(n)},c._doRedraw=function(){var a=c._computeOrderedGroups(c.data()).filter(function(a){return 0!==c.valueAccessor()(a)});q=a,f&&(o=[]),n.clearLayers();var b=[],d=[];p=[],a.forEach(function(a){if(a.value){var e=c.keyAccessor()(a),g=null;g=!f&&e in o?o[e]:u(a,e),d.push(g),c.cluster()?b.push(g):n.addLayer(g),p.push(g)}}),c.cluster()&&b.length>0&&n.addLayers(b),d.length&&(i||j&&!k)&&(d=new L.featureGroup(d),c.map().fitBounds(d.getBounds())),k=!1,i=!1},c.locationAccessor=function(a){return arguments.length?(r=a,c):r},c.marker=function(a){return arguments.length?(s=a,c):s},c.icon=function(a){return arguments.length?(t=a,c):t},c.cluster=function(a){return arguments.length?(d=a,c):d},c.clusterOptions=function(a){return arguments.length?(e=a,c):e},c.rebuildMarkers=function(a){return arguments.length?(f=a,c):f},c.brushOn=function(a){return arguments.length?(g=a,c):g},c.filterByArea=function(a){return arguments.length?(h=a,c):h},c.fitOnRender=function(a){return arguments.length?(i=a,c):i},c.fitOnRedraw=function(a){return arguments.length?(j=a,c):j},c.markerGroup=function(){return n},c.markers=function(a){return a?p:o};var u=function(a,b){var d=s(a);return d.key=b,c.renderPopup()&&d.bindPopup(c.popup()(a,d)),c.brushOn()&&!h&&d.on("click",y),o[b]=d,d},v=function(){m=!0},w=function(a){if("moveend"!==a.type||!m&&!a.hard)if(m=!1,k=!0,h){var b;b=c.map().getCenter().equals(c.center())&&c.map().getZoom()===c.zoom()?null:c.map().getBounds(),dc.events.trigger(function(){c.filter(null),b&&(l=!0,c.filter(b),l=!1),dc.redrawAll(c.chartGroup())})}else c.filter()&&("click"===a.type||c.filter()in o&&!c.map().getBounds().contains(o[c.filter()].getLatLng()))&&dc.events.trigger(function(){c.filter(null),c.renderPopup()&&c.map().closePopup(),dc.redrawAll(c.chartGroup())})},x=function(a,b){k=!0,c.dimension().filter(null),b&&b.length>0&&(c.dimension().filter(function(a){if(!(a in o))return!1;var c=o[a].getLatLng();return c&&b[0].contains(c)}),l||c.map().getBounds().toString===b[0].toString()||c.map().fitBounds(b[0]))},y=function(a){if(a.target){k=!0;var b=a.target.key;dc.events.trigger(function(){c.filter(b),dc.redrawAll(c.chartGroup())})}};return c.anchor(a,b)}}(),function(){"use strict";dc.baseGoogleChart=function(a){return a=dc.baseMapChart(a),a._doRender=function(){var b=new google.maps.Map(a.root().node(),a.mapOptions());return a.center()&&a.zoom()&&(b.setCenter(a.toLocArray(a.center())),b.setZoom(a.zoom())),a.map(b),a._postRender(),a._doRedraw()},a.toLocArray=function(a){return"string"==typeof a&&(a=a.split(",")),new google.maps.LatLng(a[0],a[1])},a}}(),function(){"use strict";dc.googleChoroplethChart=function(a,b){var c=dc.colorChart(dc.baseGoogleChart({})),d=[],e=!1,f=!1,g={fillColor:"black",color:"gray",opacity:.4,fillOpacity:.6,weight:1},h=null,i=function(a){return a.key},j=function(a){var b=c.featureOptions();b instanceof Function&&(b=b(a)),b=JSON.parse(JSON.stringify(b));var e=d[c.featureKeyAccessor()(a)];return e&&e.d&&(b.fillColor=c.getColor(e.d,e.i),-1!==c.filters().indexOf(e.d.key)&&(b.opacity=.8,b.fillOpacity=1)),b};c._postRender=function(){f="string"==typeof e?c.map().data.loadGeoJson(e):c.map().data.addGeoJson(e),c.map().data.setStyle(c.featureStyle()),k()},c._doRedraw=function(){d=[],c._computeOrderedGroups(c.data()).forEach(function(a,b){d[c.keyAccessor()(a)]={d:a,i:b}}),c.map().data.setStyle(c.featureStyle())},c.geojson=function(a){return arguments.length?(e=a,c):e},c.featureOptions=function(a){return arguments.length?(g=a,c):g},c.featureKeyAccessor=function(a){return arguments.length?(i=a,c):i},c.featureStyle=function(a){return arguments.length?(j=a,c):j};var k=function(a,b){c.renderPopup()&&c.map().data.addListener("click",function(a){var b=new google.maps.MVCObject,e=d[c.featureKeyAccessor()(a.feature)];h&&h.close(),e||(e={}),e.d||(e.d={}),h=new google.maps.InfoWindow({content:c.popup()(e.d,a.feature)}),b.set("position",a.latLng),h.open(c.map(),b)}),c.brushOn()&&c.map().data.addListener("click",l)},l=function(a){if(console.log(a),a.feature){var b=c.featureKeyAccessor()(a.feature);dc.events.trigger(function(){c.filter(b),dc.redrawAll(c.chartGroup())})}};return c.anchor(a,b)}}(),function(){"use strict";dc.googleMarkerChart=function(a,b){var c=dc.baseGoogleChart({}),d=!1,e=!1,f=!1,g=!0,h=!1,i=!0,j=!1,k=!1,l=!1,m=!1,n=[],o=[],p=!1,q=!1;c.renderTitle(!0);var r=function(a){return c.keyAccessor()(a)},s=function(a){var b=new google.maps.Marker({position:c.toLocArray(c.locationAccessor()(a)),map:c.map(),title:c.renderTitle()?c.title()(a):"",clickable:c.renderPopup()||c.brushOn()&&!h,draggable:!1});return b};c._postRender=function(){c.brushOn()&&(h&&c.filterHandler(v),google.maps.event.addListener(c.map(),"zoom_changed",function(){u("zoom")},this),google.maps.event.addListener(c.map(),"dragend",function(){u("drag")},this),h||google.maps.event.addListener(c.map(),"click",function(){u("click")},this)),d?m=new MarkerClusterer(c.map()):(m=new google.maps.OverlayView,m.setMap(c.map()))},c._doRedraw=function(){var a=c._computeOrderedGroups(c.data()).filter(function(a){return 0!==c.valueAccessor()(a)});p=a,f&&(n=[]),m.clearMarkers();var b=[],d=[],e=new google.maps.LatLngBounds;o=[],a.forEach(function(a){var g=c.keyAccessor()(a),h=null;!f&&g in n&&(h=n[g]),a.value?(null===h?h=t(a,g):h.setVisible(!0),e.extend(h.getPosition()),d.push(h),c.cluster()?b.push(h):m.addMarker(h),o.push(h)):null!==h&&h.setVisible(!1)}),c.cluster()&&b.length>0&&m.addMarkers(b),d.length&&(i||j&&!k)&&c.map().fitBounds(e),k=!1,i=!1},c.locationAccessor=function(a){return arguments.length?(r=a,c):r},c.marker=function(a){return arguments.length?(s=a,c):s},c.icon=function(a){return arguments.length?(q=a,c):q},c.cluster=function(a){return arguments.length?(d=a,c):d},c.clusterOptions=function(a){return arguments.length?(e=a,c):e},c.rebuildMarkers=function(a){return arguments.length?(f=a,c):f},c.brushOn=function(a){return arguments.length?(g=a,c):g},c.filterByArea=function(a){return arguments.length?(h=a,c):h},c.fitOnRender=function(a){return arguments.length?(i=a,c):i},c.fitOnRedraw=function(a){return arguments.length?(j=a,c):j},c.markerGroup=function(){return m},c.markers=function(a){return a?o:n};var t=function(a,b){var d=s(a);return d.key=b,c.renderPopup()&&google.maps.event.addListener(d,"click",function(){c.popup()(a,d).open(c.map(),d)}),c.brushOn()&&!h&&google.maps.event.addListener(d,"click",w),n[b]=d,d},u=function(a){if(k=!0,h){var b;b=c.map().getCenter().equals(c.toLocArray(c.center()))&&c.map().getZoom()===c.zoom()?null:c.map().getBounds(),dc.events.trigger(function(){c.filter(null),b&&(l=!0,c.filter(b),l=!1),dc.redrawAll(c.chartGroup())})}else c.filter()&&("click"===a||c.filter()in n&&!c.map().getBounds().contains(n[c.filter()].getLatLng()))&&dc.events.trigger(function(){c.filter(null),c.renderPopup()&&c.map().closePopup(),dc.redrawAll(c.chartGroup())})},v=function(a,b){k=!0,c.dimension().filter(null),b&&b.length>0&&(c.dimension().filter(function(a){if(!(a in n))return!1;var c=n[a].position;return c&&b[0].contains(c)}),l||c.map().getBounds().toString===b[0].toString()||c.map().fitBounds(b[0]))},w=function(a){if(a.target){k=!0;var b=a.target.key;dc.events.trigger(function(){c.filter(b),dc.redrawAll(c.chartGroup())})}};return c.anchor(a,b)}}(),function(){"use strict";dc.tooltipMixin=function(a){return a&&(a.tip=function(){var b="rect.bar,circle.dot,g.pie-slice path,circle.bubble,g.row rect",c=a.svg(),d=d3.tip().attr("class","tip").html(function(b){return b.data?a.title()(b.data):a.title()(b)});c.selectAll(b).call(d),c.selectAll(b).on("mouseover",d.show).on("mouseleave",d.hide),c.selectAll("title").remove()},a.tip()),a}}(),function(){"use strict";dc.bubbleCloud=function(a,b){function c(){i.elasticRadius()&&i.r().domain([i.rMin(),i.rMax()]),i.r().range([n,i.xAxisLength()*i.maxBubbleRelativeSize()]),0===p.length?d():e(),h(),o=d3.layout.force().nodes(i.data()).size([i.width(),i.height()]),o.gravity(j).charge(g).friction(l).on("tick",function(a){p.each(f(a.alpha)).attr("cx",function(a){return a.x&&a.y&&d3.select(this.parentNode).attr("transform","translate("+a.x+","+a.y+")"),0}).attr("cy",function(a){return 0})}),o.start()}function d(){r=q.selectAll("g").data(i.data()).enter().append("g").attr("class",i.BUBBLE_NODE_CLASS).on("click",i.onClick),p=r.append("circle").attr("class",i.BUBBLE_CLASS).attr("r",0).attr("fill-opacity",1).attr("fill",function(a,b){return i.getColor(a,b)}).attr("stroke-width",2).on("mouseenter",function(a,b){d3.select(this).attr("stroke","#303030")}).on("mouseout",function(a,b){d3.select(this).attr("stroke","none")}),i._doRenderLabel(r),i._doRenderTitles(r),p.transition().duration(k).attr("r",function(a){return a.radius=i.bubbleR(a),a.x=Math.random()*i.width(),a.y=Math.random()*i.height(),a.radius})}function e(){p.data(i.data()).attr("r",function(a){return a.radius=i.bubbleR(a),a.radius}),i.doUpdateLabels(r),i.doUpdateTitles(r)}function f(a){var b=d3.geom.quadtree(i.data());return function(c){var d=c.radius+d3.max(i.data().map(function(a){return a.radius}))+m,e=c.x-d,f=c.x+d,g=c.y-d,h=c.y+d;b.visit(function(b,d,i,j,k){if(b.point&&b.point!==c){var l=c.x-b.point.x,n=c.y-b.point.y,o=Math.sqrt(l*l+n*n),p=c.radius+b.point.radius+m;p>o&&(o=(o-p)/o*a,c.x-=l*=o,c.y-=n*=o,b.point.x+=l,b.point.y+=n)}return d>f||e>j||i>h||g>k})}}function g(a){return-Math.pow(a.radius,2)/8}function h(){i.hasFilter()?r.each(function(a){i.hasFilter(i.keyAccessor()(a))?i.highlightSelected(this):i.fadeDeselected(this)}):r.each(function(){i.resetHighlight(this)})}var i=dc.bubbleMixin(dc.capMixin(dc.bubbleChart())),j=.2,k=1500,l=.5,m=10,n=5,o=null,p=[],q=null,r=null;return i._doRender=function(){return i.resetSvg(),q=i.svg().append("g"),p=[],c(),i},i._doRedraw=function(){return c(),i},i.anchor(a,b)}}(),function(){"use strict";dc.pairedRowChart=function(a,b){function c(a){e[a]=function(b){return arguments.length?(h[a](b),i[a](b),e):h[a]()}}function d(a){e[a]=function(){return h[a](),i[a](),e}}var e=dc.capMixin(dc.marginMixin(dc.colorMixin(dc.baseMixin({})))),f=d3.select(a).append("div"),g=d3.select(a).append("div"),h=dc.rowChart(f[0][0],b),i=dc.rowChart(g[0][0],b);h.useRightYAxis(!0);var j=function(a){return a.key[0]},k=function(a){return a.key[0]};e.leftKeyFilter=function(a){return arguments.length?(j=a,e):j},e.rightKeyFilter=function(a){return arguments.length?(k=a,e):k},h.data(function(a){var b=h.cap(),c=a.all().filter(function(a){return e.leftKeyFilter()(a)});return b===1/0?c:c.slice(0,b)}),i.data(function(a){var b=i.cap(),c=a.all().filter(function(a){return e.rightKeyFilter()(a)});return b===1/0?c:c.slice(0,b)}),h.onClick=i.onClick=function(a){var b=h.keyAccessor()(a);dc.events.trigger(function(){h.filter(b),i.filter(b),h.redrawGroup()})};var l=e.margins();e.margins=function(a){return arguments.length?(l=a,h.margins({top:a.top,right:0,bottom:a.bottom,left:a.left}),i.margins({top:a.top,right:a.right,bottom:a.bottom,left:0}),e):l},e.margins(l),e.svg=function(){return d3.selectAll([h.svg()[0][0],i.svg()[0][0]])},h.calculateAxisScaleData?h.calculateAxisScaleData=i.calculateAxisScaleData=function(){return h.data().concat(i.data())}:e.group=function(a){if(!arguments.length)return h.group();h.group(a),i.group(a);var b=d3.extent(a.all(),e.cappedValueAccessor);return b[0]>0&&(b[0]=0),h.x(d3.scale.linear().domain(b).range([h.effectiveWidth(),0])),i.x(d3.scale.linear().domain(b).range([0,i.effectiveWidth()])),e};for(var m=["height","width","minHeight","minWidth","renderTitleLabel","fixedBarHeight","gap","othersLabel","transitionDuration","label","renderLabel","title","renderTitle","chartGroup","colors","ordinalColors","linearColors","colorAccessor","colorDomain","getColor","colorCalculator","x","elasticX","valueAccessor","labelOffsetX","titleLabelOffsetx","keyAccessor","labelOffsetY","cap","ordering","dimension","group","othersGrouper","data"],n=0;n<m.length;n++)c(m[n]);var o=["_doRedraw","redraw","_doRender","render","calculateColorDomain","filterAll","resetSvg","expireCache"];for(n=0;n<o.length;n++)d(o[n]);return e.anchor(a,b)}}(),function(){"use strict";"dc"in window||(window.dc={}),dc.serverChart=function(a){function b(a){var b=document.createElement("div");b.innerHTML=a,b=d3.select(b),o.selectAll(".dc-chart").each(function(a,d){var e=d3.select(this),f=b.selectAll(".dc-chart").filter(function(a,b){return b===d}),g=l(e);"function"==typeof dc.serverChart["redraw"+g]?dc.serverChart["redraw"+g](d,e,f):(e.html(f.html()),c())})}function c(){o.selectAll(".dc-chart").each(function(a,b){var c=d3.select(this),d=l(c);"function"==typeof dc.serverChart["attachEvents"+d]&&dc.serverChart["attachEvents"+d](b,c)})}function d(a,b){if(b.select("g.brush").size()>0){var c=b.select("g.brush").select(".background").attr("width");b.select("g.brush").on("mousedown",function(){q=d3.mouse(this),u=s,t=r}).on("mousemove",function(){if(null!==q){var a=d3.mouse(this),b=d3.select(this),d=null;if(v){var e=a[0]-q[0];s=u+e,r=t+e,0>s&&(s=0,r=t-u),r>c&&(r=c,s=c-(t-u))}else w?(s=s,r=a[0],s>r&&(d=s,s=r,r=d,w=!1,x=!0),0>s&&(s=0),r>c&&(r=c)):x?(s=a[0],r=r,s>r&&(d=s,s=r,r=d,w=!0,x=!1),0>s&&(s=0),r>c&&(r=c)):(s=d3.min([a[0],q[0]]),r=d3.max([a[0],q[0]]),0>s&&(s=0),r>c&&(r=c));b.select(".extent").attr("x",s).attr("width",r-s),b.selectAll("g.resize").style("display","inline"),b.select("g.resize.e").attr("transform","translate("+r+", 0)"),b.select("g.resize.w").attr("transform","translate("+s+", 0)")}}).on("mouseup",function(){var b=d3.mouse(this),c=d3.select(this);null===q||b[0]===q[0]?(c.select(".extent").attr("width",0),c.selectAll("g.resize").style("display","none"),e(a,[null,null])):e(a,[s,r]),q=null}),b.select("g.brush").select(".extent").on("mousedown",function(){v=!0}).on("mouseup",function(){v=!1}),b.select("g.brush").select("g.resize.e").on("mousedown",function(){w=!0}).on("mouseup",function(){w=!1}),b.select("g.brush").select("g.resize.w").on("mousedown",function(){x=!0}).on("mouseup",function(){x=!1})}}function e(a,b){n.emit("filter",[a,b])}function f(){if(j(),!p.name)throw Error("Name is a required option");n.emit("render",p.name)}function g(a){o.selectAll("*").remove();for(var b=0;b<a.length;b++)o.append("div").style("width",a[b].width+"px").style("height",a[b].height+"px").style("float","left").style("text-align","center").style("line-height",a[b].height+"px").html(p.loadingMessage)}function h(a){o.html(a),c()}function i(a){o.html(p.errorMessage),console.warn(a)}function j(){o.html(p.loadingMessage)}function k(){n=io(p.server,{reconnectionDelay:500,reconnectionDelayMax:2e3,reconnectionAttempts:4}),n.on("preRender",g),n.on("afterRender",h),n.on("afterRenderError",i),n.on("afterFilter",b),n.on("afterFilterError",i),n.io.on("reconnecting",function(){o.html(p.reconnectingMessage)}),n.io.on("reconnect_failed",function(){o.html(p.connectionErrorMessage)})}function l(a){var b=a.attr("data-type").split("");return b[0]=b[0].toUpperCase(),b=b.join("")}var m={},n=null,o=d3.select(a),p={name:null,server:"http://127.0.0.1:3000/",errorMessage:"A problem occurred creating the charts. Please try again later",loadingMessage:"Loading",reconnectingMessage:"There appears to be a problem connecting to the server. Retyring...",connectionErrorMessage:"Could not connect to the server."},q=null,r=null,s=null,t=null,u=null,v=!1,w=!1,x=!1;return dc.serverChart.attachEventsBarChart=function(a,b){b.selectAll("rect.bar").on("click",function(b,c){e(a,c)}),d(a,b)},dc.serverChart.attachEventsPieChart=function(a,b){b.selectAll("g.pie-slice").on("click",function(b,c){e(a,c)})},dc.serverChart.attachEventsRowChart=function(a,b){b.selectAll("g.row").selectAll("rect").on("click",function(b,c,d){e(a,d)})},dc.serverChart.attachEventsLineChart=function(a,b){b.selectAll("circle.dot").on("mousemove",function(){var a=d3.select(this);a.style("fill-opacity",.8),a.style("stroke-opacity",.8)}).on("mouseout",function(){var a=d3.select(this);a.style("fill-opacity",.01),a.style("stroke-opacity",.01)}),d(a,b)},m.render=function(){return k(),f(),m},m.options=function(a){if(0===arguments.length)return p;for(var b in a)a.hasOwnProperty(b)&&(p[b]=a[b]);return m},j(),m}}(),function(){"use strict";function a(a,c,d){c.selectAll(".axis").each(function(a,g){var h=d3.select(this),i=h.select("path.domain").node().getBBox(),j=h.selectAll("g.tick"),k=null!==/translate\([\d.]+,0\)/i.exec(d3.select(j[0][1]).attr("transform")),l=b(d.selectAll(".axis"),g),m=l.selectAll("g.tick"),n=parseFloat(d3.select(m[0][0]).select("text").text()),o=parseFloat(d3.select(m[0][m[0].length-1]).select("text").text()),p=c.select(k?".grid-line.vertical":".grid-line.horizontal"),q=d.select(k?".grid-line.vertical":".grid-line.horizontal");h.transition().duration(e).ease(f).attr("transform",l.attr("transform")),p.empty()||p.transition().duration(e).ease(f).attr("transform",q.attr("transform")),j.each(function(a,c){var d=d3.select(this),g=d.select("text"),h=parseFloat(g.text()),j=(h-n)/(o-n)*100,l=!1;if(m.each(function(a,g){var i=d3.select(this),j=i.select("text");if(parseFloat(j.text())===h&&(l=!0,d.transition().duration(e).ease(f).attr("transform",i.attr("transform")).attr("opacity",null).style("opacity",i.attr("opacity")).each("end",function(){d.select("text").text(i.select("text").text())}),!p.empty())){var k=b(p.selectAll("line"),c),m=b(q.selectAll("line"),g);k.transition().duration(e).ease(f).attr("x1",m.attr("x1")).attr("y1",m.attr("y1")).attr("x2",m.attr("x2")).attr("y2",m.attr("y2")).attr("transform",null).style("opacity",m.attr("opacity"))}}),!l){var r="";if(r=k?"translate("+i.width*j/100+", 0)":"translate(0, "+(i.height-i.height*j/100)+")",d.transition().duration(e).ease(f).attr("transform",r).style("opacity",0).each("end",function(){d.remove()}),!p.empty()){var s=b(p.selectAll("line"),c);s.transition().duration(e).ease(f).attr("transform",r).style("opacity",0).each("end",function(){s.remove()})}}})}),d.selectAll(".axis").each(function(a,g,h){var i=d3.select(this),j=i.selectAll("g.tick"),k=null!==/translate\([\d.]+,0\)/i.exec(d3.select(j[0][1]).attr("transform")),l=b(c.selectAll(".axis"),g),m=l.select("path.domain").node().getBBox(),n=l.selectAll("g.tick"),o=parseFloat(d3.select(n[0][0]).select("text").text()),p=parseFloat(d3.select(n[0][n[0].length-1]).select("text").text()),q=c.select(k?".grid-line.vertical":".grid-line.horizontal"),r=d.select(k?".grid-line.vertical":".grid-line.horizontal");j.each(function(a,c){var d=d3.select(this),g=d.select("text"),h=d.select("line"),i=parseFloat(g.text()),j=(i-o)/(p-o)*100,s=!1;if(n.each(function(a,b){var c=d3.select(this),d=c.select("text");parseFloat(d.text())===i&&(s=!0)}),!s){var t=0,u="",v="",w=null;w=q.empty()?d.select("line.grid-line"):b(r.selectAll("line"),c),k?(t=m.width*j/100,u="translate("+t+", 0)",v="translate("+(t-w.attr("x1"))+", 0)"):(t=m.height-m.height*j/100,u="translate(0, "+t+")",v="translate(0, "+(t-w.attr("y1"))+")");var x=l.append("g").attr("class","tick").attr("transform",u).attr("opacity",0);x.transition().duration(e).ease(f).attr("transform",d.attr("transform")).style("opacity",1),x.append("text").attr("x",g.attr("x")).attr("y",g.attr("y")).attr("dy",g.attr("dy")).attr("style",g.attr("style")).text(g.text()),x.append("line").attr("x1",h.attr("x1")).attr("y1",h.attr("y1")).attr("x2",h.attr("x2")).attr("y2",h.attr("y2")),q.empty()?x.append("line").attr("class",w.attr("class")).attr("x1",w.attr("x1")).attr("y1",w.attr("y1")).attr("x2",w.attr("x2")).attr("y2",w.attr("y2")):q.append("line").attr("x1",w.attr("x1")).attr("y1",w.attr("y1")).attr("x2",w.attr("x2")).attr("y2",w.attr("y2")).attr("transform",v).attr("opacity",0).transition().duration(e).ease(f).attr("transform","translate(0, 0)").style("opacity",1)}})})}function b(a,b){return a.filter(function(a,c){return c===b})}function c(a){var b=a.match(g);if(!b)return{startAngle:0,endAngle:2*Math.PI};var c={x1:parseFloat(b[5]),y1:parseFloat(b[6]),x2:parseFloat(b[1]),y2:parseFloat(b[2]),x3:parseFloat(b[3]),y3:parseFloat(b[4])},e={startAngle:d(Math.atan2(c.y2-c.y1,c.x2-c.x1)),endAngle:d(Math.atan2(c.y3-c.y1,c.x3-c.x1))};return e.startAngle<0&&(e.startAngle=0),(e.endAngle>2*Math.PI||e.endAngle<e.startAngle)&&(e.endAngle=2*Math.PI),e}function d(a){var b=.5*Math.PI;return a>=0?b+a:a>=-b?b-Math.abs(a):2.5*Math.PI-Math.abs(a)}var e=350,f="quad-in",g=new RegExp(["M ?([\\d\\.e-]+) ?, ?([\\d\\.e-]+) ?","A ?","[\\d\\.e-]+ ?, ?[\\d\\.e-]+ ?,? ","\\d ,? ?","\\d ?,? ?","\\d ?,? ?","([\\d\\.e-]+) ?,? ?([\\d\\.e-]+) ?","L ?([\\d\\.e-]+) ?,? ?([\\d\\.e-]+)","Z"].join(""));dc.serverChart.redrawPieChart=function(a,d,g){var h=d.select("svg"),i=d.selectAll("g.pie-slice"),j=g.selectAll("g.pie-slice");d.selectAll("text").each(function(a,c){var d=d3.select(this),h=b(g.selectAll("text"),c);d.text(h.text()).transition().duration(e).ease(f).attr("transform",h.attr("transform"))}),i.attr("class",function(a,c){return b(j,c).attr("class")}),i.select("title").text(function(a,c){return b(j,c).select("title").text()}),i.select("path").transition().duration(e).ease(f).attrTween("d",function(a,d,e){var f=d3.min([h.attr("width"),h.attr("height")])/2,g=d3.svg.arc().outerRadius(f).innerRadius(0),i=b(j,d).select("path").attr("d"),k=d3.interpolate(c(e),c(i));return function(a){return g(k(a))}})},dc.serverChart.redrawBarChart=function(c,d,g){var h=d.selectAll("rect.bar"),i=g.selectAll("rect.bar");h.each(function(a,c){var d=d3.select(this),g=b(i,c);d.attr("class",g.attr("class")).attr("fill",g.attr("fill")).transition().duration(e).ease(f).attr("x",g.attr("x")).attr("y",g.attr("y")).attr("width",g.attr("width")).attr("height",g.attr("height"))}),h.select("title").each(function(a,c){var d=d3.select(this),e=b(i,c).select("title");d.text(e.text())}),a(c,d,g)},dc.serverChart.redrawRowChart=function(c,d,g){d.selectAll("g.row").each(function(a,c){var d=d3.select(this),h=b(g.selectAll("g.row"),c),i=h.select("rect"),j=h.select("text"),k=h.select("title");d.transition().duration(e).ease(f).attr("transform",h.attr("transform")),d.select("rect").attr("class",i.attr("class")).transition().duration(e).ease(f).attr("width",i.attr("width")).attr("height",i.attr("height")).attr("fill",i.attr("fill")).attr("transform",i.attr("transform")),d.select("text").text(j.text()).transition().duration(e).ease(f).attr("x",j.attr("x")).attr("y",j.attr("y")).attr("dy",j.attr("dy")).attr("transform",j.attr("transform")),d.select("title").text(k.text())}),a(c,d,g)},dc.serverChart.redrawLineChart=function(c,d,g){d.selectAll("g.stack").each(function(a,c){var d=d3.select(this),h=b(g.selectAll("g.stack"),c);d.selectAll("path").each(function(a,c){var d=d3.select(this),g=b(h.selectAll("path"),c);d.transition().duration(e).ease(f).attr("stroke",g.attr("stroke")).attr("d",g.attr("d"))})}),a(c,d,g)}}();